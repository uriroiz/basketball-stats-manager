<!DOCTYPE html>
<html>
<head>
  <meta charset="UTF-8">
  <title>Test Edge Function</title>
</head>
<body>
  <h1>Test Edge Function Authentication</h1>
  <button onclick="testFunction()">Test Edge Function</button>
  <pre id="result"></pre>

  <script>
    async function testFunction() {
      const password = 'UriPixellot1982!';
      const supabaseUrl = 'https://ruzfbkxiqusfbiyxyegb.supabase.co';
      const anonKey = 'eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJzdXBhYmFzZSIsInJlZiI6InJ1emZia3hpcXVzZmJpeXh5ZWdiIiwicm9sZSI6ImFub24iLCJpYXQiOjE3NjMxMTkyNDEsImV4cCI6MjA3ODY5NTI0MX0.UjzpGJ9Xx_T-74FBamNF9T7pQWyEFgcSYf_TkQs3E38';
      
      const testData = {
        gameData: {
          gameSerial: 999,
          date: '2025-01-19',
          cycle: '1',
          teams: ['Test1', 'Test2'],
          timestamp: new Date().toISOString(),
          originalJson: '{}'
        },
        playersData: []
      };
      
      document.getElementById('result').textContent = 'Sending request...\n';
      document.getElementById('result').textContent += `Password: ${password}\n`;
      document.getElementById('result').textContent += `URL: ${supabaseUrl}/functions/v1/save-game\n\n`;
      
      try {
        const response = await fetch(`${supabaseUrl}/functions/v1/save-game`, {
          method: 'POST',
          headers: {
            'Content-Type': 'application/json',
            'Authorization': `Bearer ${anonKey}`,
            'apikey': anonKey,
            'x-admin-password': password
          },
          body: JSON.stringify(testData)
        });
        
        document.getElementById('result').textContent += `Status: ${response.status} ${response.statusText}\n\n`;
        
        const text = await response.text();
        document.getElementById('result').textContent += `Response:\n${text}`;
        
      } catch (error) {
        document.getElementById('result').textContent += `Error: ${error.message}`;
      }
    }
  </script>
</body>
</html>

